---

- hosts: localhost
  connection: local

  pre_tasks:

  - name: ensure ~/bin
    file:
      name: ~/bin
      state: directory
    tags: user

  - name: ensure venv
    package:
      name: python3-venv
    become: true
    tags: admin

  - name: ensure pip3
    package:
      name: python3-pip
    become: true
    tags: admin

  - name: ensure pipx
    pip:
      name: pipx
      executable: pip3
      extra_args: --user
    tags: user

  roles:
    - {role: ansible, tags: ['ansible', 'setup']}
    - {role: byobu, tags: ['byobu', 'shell']}
    - {role: compose, tags: ['compose', 'develop']}
    - {role: cookiecutter, tags: ['cookiecutter', 'develop']}
    - {role: ctags, tags: ['ctags', 'search']}
    - {role: functools, tags: ['functools', 'analyze']}
    - {role: fzf, tags: ['fzf', 'filter']}
    - {role: git, tags: ['git', 'develop']}
    - {role: glances, tags: ['glances', 'monitor']}
    - {role: glom, tags: ['glom', 'filter']}
    - {role: howdoi, tags: ['howdoi', 'assist']}
    - {role: httpie, tags: ['httpie', 'network']}
    - {role: litecli, tags: ['litecli', 'shell']}
    - {role: mario, tags: ['mario', 'analyze']}
    - {role: metrics, tags: ['metrics', 'analyze']}
    - {role: ncdu, tags: ['ncdu', 'monitor']}
    - {role: neovim, tags: ['neovim', 'editor']}
    - {role: pint, tags: ['pint', 'analyze']}
    - {role: ptrepl, tags: ['ptrepl', 'shell']}
    - {role: pydoro, tags: ['pydoro', 'analyze']}
    - {role: ranger, tags: ['ranger', 'browser']}
    - {role: scapy, tags: ['scapy', 'network']}
    - {role: schedule, tags: ['schedule', 'trigger']}
    - {role: shutit, tags: ['shutit', 'setup']}
    - {role: silver, tags: ['silver', 'search']}
    - {role: supervisor, tags: ['supervisor', 'setup']}
    - {role: termtosvg, tags: ['termtosvg', 'record']}
    - {role: tqdm, tags: ['tqdm', 'monitor']}
    - {role: w3m, tags: ['w3m', 'browser']}
    - {role: watchdog, tags: ['watchdog', 'trigger']}
    - {role: wharfee, tags: ['wharfee', 'shell']}
    - {role: xonsh, tags: ['xonsh', 'shell']}

  environment:
    PATH: "{{ ansible_user_dir}}/.local/bin/:{{ ansible_env.PATH }}"
