---

- hosts: localhost
  become: true

  tasks:

  - name: getting fedora version
    command: "rpm -E %fedora"
    register: fedora_version

  - name: installing selinux bindings
    dnf: pkg="libselinux-python" state=latest

  - name: setting selinux to permissive
    replace: path="/etc/selinux/config" regexp='^SELINUX=.*' replace='SELINUX=permissive'

  - name: installing rpm Fusion repository
    dnf: name="{{item}}" state='present' disable_gpg_check=true
    with_items:
      - https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-{{fedora_version.stdout}}.noarch.rpm
      - https://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-{{fedora_version.stdout}}.noarch.rpm

  - name: installing graphic driver
    dnf: pkg="akmod-nvidia" state=latest

  - name: installing media codecs
    dnf: pkg="{{item}}" state=latest
    with_items:
      - gstreamer-ffmpeg
      - gstreamer-plugins-bad
      - gstreamer-plugins-bad-free-extras
      - gstreamer-plugins-bad-nonfree
      - gstreamer-plugins-ugly
      - gstreamer1
      - gstreamer1-libav
      - gstreamer1-plugins-bad-free
      - gstreamer1-plugins-bad-free-extras
      - gstreamer1-plugins-bad-freeworld
      - gstreamer1-plugins-base
      - gstreamer1-plugins-base-tools
      - gstreamer1-plugins-good
      - gstreamer1-plugins-good-extras
      - gstreamer1-plugins-ugly
      - p7zip-plugins
      - p7zip
      - unrar
