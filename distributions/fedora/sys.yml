---

- hosts: localhost
  become: true

  tasks:

  - name: Getting fedora version
    command: "rpm -E %fedora"
    register: fedora_version

  - name: Setting selinux to permissive mode (fedora)
    replace: path="/etc/selinux/config" regexp='^SELINUX=.*' replace='SELINUX=permissive'
    when: ansible_distribution == 'Fedora'

  - name: Installing selinux python binding (fedora)
    dnf: pkg="libselinux-python" state=latest
    when: ansible_distribution == 'Fedora'

  - name: Installing rpm Fusion repository (fedora)
    dnf: name="{{item}}" state='present' disable_gpg_check=true
    with_items:
      - https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-{{fedora_version.stdout}}.noarch.rpm
      - https://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-{{fedora_version.stdout}}.noarch.rpm
    when: ansible_distribution == 'Fedora'

  - name: Installing adobe repository (fedora)
    copy: src="{{playbook_dir}}/adobe.repo" dest="/etc/yum.repos.d/adobe.repo" owner='root' group='root' mode='0644'
    when: ansible_distribution == 'Fedora'

  - name: Installing media codecs (fedora)
    dnf: pkg="{{item}}" state=latest
    with_items:
      - vlc
      - gstreamer-ffmpeg
      - gstreamer-plugins-bad
      - gstreamer-plugins-bad-free-extras
      - gstreamer-plugins-bad-nonfree
      - gstreamer-plugins-ugly
      - gstreamer1
      - gstreamer1-libav
      - gstreamer1-plugins-bad-free
      - gstreamer1-plugins-bad-free-extras
      - gstreamer1-plugins-bad-freeworld
      - gstreamer1-plugins-base
      - gstreamer1-plugins-base-tools
      - gstreamer1-plugins-good
      - gstreamer1-plugins-good-extras
      - gstreamer1-plugins-ugly
      - p7zip
      - p7zip-plugins
      - unrar
    when: ansible_distribution == 'Fedora'
