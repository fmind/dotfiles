---

- hosts: localhost
  connection: local

  tasks:

  - name: Installing Python libraries
    pip: name="{{item}}" executable="pip3" extra_args="--user" state=latest
    with_items:
      # syntax
      - hy
      - yapf
      - flake8
      - autoflake
      - pep8-naming
      # project
      - ipdb
      - isort
      - wheel
      - twine
      - fabric
      - sphinx
      - autoenv
      - docutils
      - pygments
      - virtualenv
      - pytest-cov
      - cookiecutter
      - pytest-xdist
      - check-manifest
      # system
      - sh
      - envoy
      - glances
      # parsers
      - shyaml
      - csvkit
      # analysis
      - jupyter
      - ipython
      - ipyparallel
      # web client
      - httpie
      - http-prompt

  - name: Checking if ipython profile exists
    stat: path="~/.ipython/profile_fmind/"
    register: ipython_profile

  - name: Creating ipython profile for fmind
    command: "~/.local/bin/ipython3 profile create fmind"
    when: ipython_profile.stat.exists == False

  - name: Deploying ipython configuration for fmind
    file: src="{{ansible_env.PWD}}/python/{{item}}" dest="~/.ipython/{{item}}" state=link force=yes
    with_items:
      - profile_fmind/ipython_config.py

  - name: Creating ~/.config/yapf directory
    file: path="~/.config/yapf" state=directory

  - name: Deploying yapf configuration for user
    file: src="{{ansible_env.PWD}}/python/{{item}}" dest="~/.config/{{item}}" state=link force=yes
    with_items:
      - yapf/style

  - name: Deploying flake8 configuration for user
    file: src="{{ansible_env.PWD}}/python/{{item}}" dest="~/.config/{{item}}" state=link force=yes
    with_items:
      - flake8

  - name: Deploying pypi configuration
    file: src="{{ansible_env.PWD}}/python/{{item}}" dest="~/.{{item}}" state=link force=yes
    with_items:
      - pypirc

  - name: Deploying cookiecutter configuration
    file: src="{{ansible_env.PWD}}/python/{{item}}" dest="~/.{{item}}" state=link force=yes
    with_items:
      - cookiecutterrc
